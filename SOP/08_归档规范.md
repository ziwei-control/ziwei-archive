# 紫微智控 - 归档与变现规范

## 机制概述

**通信官** 负责执行归档机制，将成功项目推送到 GitHub 并管理变现资产。

| 项目 | 规格 |
|------|------|
| **归档触发** | 任务交付后 8 小时 |
| **归档平台** | GitHub 私有仓库 |
| **本地策略** | 只上传，不删除本地文件 |
| **变现评估** | 自动评分，高分项目标记待发布 |

---

## 档案库结构

```
repo_archive/
├── SUCCESS/
│   ├── PENDING_RELEASE/          # 高分待发布项目（可变现）
│   │   ├── [Score_95]_20250227_AiChatbot_React/
│   │   │   ├── code/              # 可复用代码
│   │   │   ├── assets/            # 配套资源
│   │   │   ├── case.md            # 案例说明（含收益记录）
│   │   │   └── score_report.md    # 自动评分报告
│   │   └── [Score_90]_20250228_Game_Love2D/
│   ├── ARCHIVE/                   # 历史成功案例存档
│   └── FAILED_CANDIDATES/         # 评分低，仅存档
├── FAILURE/                       # 失败案例（避坑指南）
│   └── [日期]_[任务 ID]_[原因]/
│       └── report.md              # 根本原因分析
└── ERROR/                         # 系统错误（技术复盘）
    └── [日期]_[错误类型]/
        └── log.md                 # 错误日志与修复方案
```

---

## 自动评分机制

### 评分维度

| 维度 | 权重 | 评分标准 |
|------|------|---------|
| **复杂度** | 30% | 单模型 (30 分) / 双模型协作 (60 分) / 多模型 + 视觉 (90-100 分) |
| **创新性** | 25% | 常规实现 (30 分) / 新颖方案 (60 分) / 突破性创新 (90-100 分) |
| **完整性** | 25% | 仅代码 (30 分) / 代码 + 文档 (60 分) / 代码 + 文档 + 测试 (90-100 分) |
| **可复用性** | 20% | 一次性脚本 (30 分) / 模块化组件 (60 分) / 通用框架 (90-100 分) |

### 评分公式

```
总分 = 复杂度×0.30 + 创新性×0.25 + 完整性×0.25 + 可复用性×0.20
```

### 评分等级

| 分数范围 | 等级 | 处理 |
|---------|------|------|
| 90-100 | S 级 | 立即标记 PENDING_RELEASE，优先变现 |
| 80-89 | A 级 | 标记 PENDING_RELEASE，排队变现 |
| 70-79 | B 级 | 存入 ARCHIVE，可选择性变现 |
| <70 | C 级 | 存入 FAILED_CANDIDATES，仅存档 |

### 评分报告模板

**文件**: `score_report.md`

```markdown
# 项目评分报告

## 基本信息
- **任务 ID**: TASK-XXX
- **项目名称**: [名称]
- **完成时间**: [时间]
- **评分时间**: [时间]

## 评分详情

### 复杂度 (30%)
- **得分**: XX/100
- **理由**: [说明，如：使用了 V-01+T-01+T-02 三岗位协作]

### 创新性 (25%)
- **得分**: XX/100
- **理由**: [说明，如：采用新颖的架构设计]

### 完整性 (25%)
- **得分**: XX/100
- **理由**: [说明，如：包含代码、文档、测试用例]

### 可复用性 (20%)
- **得分**: XX/100
- **理由**: [说明，如：高度模块化，可移植性强]

## 总分
**XX/100** - [S/A/B/C] 级

## 变现建议
- [ ] 推荐发布到 CodeCanyon
- [ ] 推荐发布到 GitHub Marketplace
- [ ] 推荐作为 Upwork/Fiverr 作品集
- [ ] 仅存档，不变现

## 估价参考
- **市场估价**: $XX - $XXX
- **建议售价**: $XX
```

---

## 归档流程

### 8 小时倒计时

```
任务交付完成
    ↓
记录交付时间 T
    ↓
等待 8 小时
    ↓
T+8h 触发归档
    ↓
通信官执行归档
```

### 归档步骤

1. **检测归档时间**
   - 扫描 `data/logs/delivery_*.md`
   - 计算 交付时间 + 8 小时

2. **执行评分**
   - 调用 T-01 首席架构师进行自动评分
   - 生成 `score_report.md`

3. **分类归档**
   - S/A 级 → 复制到 `SUCCESS/PENDING_RELEASE/`
   - B 级 → 复制到 `SUCCESS/ARCHIVE/`
   - C 级 → 复制到 `SUCCESS/FAILED_CANDIDATES/`

4. **推送 GitHub**
   - git add .
   - git commit -m "[归档] [任务 ID] [项目名称] 评分：XX"
   - git push origin main

5. **记录归档**
   - 生成 `data/logs/archive_[任务 ID].md`
   - 更新项目 `case.md` 中的"已归档至云端"

---

## 变现渠道与策略

### 变现渠道

| 渠道 | 适合类型 | 分成 | 结算 |
|------|---------|------|------|
| **CodeCanyon** | 完整应用、组件、插件 | 50-70% | 月结 |
| **GitHub Marketplace** | GitHub Apps、Actions | 80-100% | 月结 |
| **Upwork** | 定制项目、作品集展示 | 平台 20% | 项目结算 |
| **Fiverr** | 小型服务、快速交付 | 平台 20% | 项目结算 |
| **码市（国内）** | 国内客户定制 | 平台 10-20% | 项目结算 |

### 发布流程

```
1. Martin 浏览 PENDING_RELEASE 文件夹
    ↓
2. 选择要发布的项目
    ↓
3. 打包项目（zip）
    ↓
4. 准备发布材料：
   - 项目描述
   - 功能截图
   - 使用文档
   - 演示视频（可选）
    ↓
5. 上传到目标平台
    ↓
6. 设置价格（参考评分报告估价）
    ↓
7. 发布上线
    ↓
8. 记录收益到 case.md
```

### 收益记录

**文件**: `case.md`

```markdown
# 项目案例：[项目名称]

## 基本信息
- **任务 ID**: TASK-XXX
- **完成时间**: 2025-02-27
- **评分**: 95/100 (S 级)

## 项目描述
[项目功能说明]

## 技术栈
- [技术 1]
- [技术 2]

## 变现记录
| 日期 | 渠道 | 售价 | 状态 |
|------|------|------|------|
| 2025-03-01 | CodeCanyon | $49 | 已上线 |
| 2025-03-05 | Upwork 作品 | - | 吸引客户 |

## 累计收益
**$XXX**

## 客户反馈
[如有，记录客户评价]
```

---

## 失败案例管理

### 失败分类

| 类型 | 说明 | 示例 |
|------|------|------|
| **流程合规** | Prompt 写法不当、逻辑错误 | 触发合规红线 |
| **需求理解** | 用户需求模糊、理解偏差 | 做出来的不是想要的 |
| **技术限制** | 模型能力不足、API 限制 | 超出上下文窗口 |
| **系统故障** | 卡死、重启、数据丢失 | 急救机制触发 |

### 失败报告模板

**文件**: `FAILURE/[日期]_[任务 ID]_[原因]/report.md`

```markdown
# 失败案例报告

## 基本信息
- **日期**: 2025-02-27
- **任务 ID**: TASK-XXX
- **错误类型**: [Prompt Injection / API 限流 / 等]

## 现象描述
[详细描述失败现象]

## 根本原因分析
[5 Why 分析法，找到根本原因]

## 修复方案
1. [修复步骤 1]
2. [修复步骤 2]

## 吸取的教训
[一句话总结教训，如：永远不要信任用户输入]

## 预防措施
[如何防止类似问题再次发生]
```

---

## 系统错误管理

### 错误分类

| 类型 | 说明 | 示例 |
|------|------|------|
| **API 调用失败** | 网络超时、服务端错误 | 429 限流、503 不可用 |
| **权限不足** | API Key 失效、配额用尽 | 401 未授权 |
| **资源超限** | 内存溢出、磁盘满 | OOM、No space left |
| **逻辑错误** | 脚本 Bug、死循环 | 无限递归 |

### 错误报告模板

**文件**: `ERROR/[日期]_[错误类型]/log.md`

```markdown
# 系统错误报告

## 基本信息
- **日期**: 2025-02-27
- **错误类型**: [Vision_Model_Timeout / DB_Lock / 等]
- **影响任务**: [任务 ID]

## 错误日志
```
[粘贴原始错误日志]
```

## 原因分析
[技术原因分析]

## 修复方案
[已执行的修复操作]

## 预防措施
[如何防止再次发生]
```

---

## GitHub 仓库管理

### 仓库结构

```
ziwei-archive (GitHub 私有仓库)
├── SUCCESS/
│   ├── PENDING_RELEASE/
│   └── ARCHIVE/
├── FAILURE/
└── ERROR/
```

### 提交规范

```
[归档] [任务 ID] [项目名称] 评分：XX

- 任务类型：[代码生成/文档撰写/等]
- 使用模型：[模型列表]
- 评分等级：[S/A/B/C]
- 变现渠道：[CodeCanyon/等]
```

### 权限管理

| 角色 | 权限 |
|------|------|
| Martin | 管理员（读写 + 设置） |
| 康纳 | 只读（查看归档） |
| 紫微系统 | 自动推送（CI/CD token） |

---

**版本**: 1.0  
**最后更新**: 2025-02-27  
**状态**: 生效中

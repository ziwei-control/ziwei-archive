#!/bin/bash
# =============================================================================
# ç´«å¾®æ™ºæŽ§ - ä¸€é”®å¯åŠ¨ä»»åŠ¡è„šæœ¬
# åŠŸèƒ½ï¼šåˆ›å»ºé¡¹ç›® â†’ åŒæ­¥ â†’ æ‹‰å–ä»»åŠ¡ â†’ è‡ªåŠ¨æ‰§è¡Œ â†’ æ¯æ­¥æŒ‰éƒ¨å°±ç­
# =============================================================================

# æ³¨æ„ï¼šä¸ä½¿ç”¨ set -eï¼Œé‡‡ç”¨å®¹é”™æœºåˆ¶
# set -e

# è‡ªåŠ¨å®šä½åˆ° Ziwei ç›®å½•ï¼ˆæ— è®ºåœ¨å“ªä¸ªç›®å½•æ‰§è¡Œï¼‰
Ziwei_DIR="/home/admin/Ziwei"
cd "$Ziwei_DIR"

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
MAGENTA='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

# =============================================================================
# äº¤äº’å¼å‚æ•°è¾“å…¥
# =============================================================================

# æ£€æŸ¥æ˜¯å¦æä¾›äº†å‚æ•°
if [ -n "$1" ]; then
    # ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°
    TASK_ID="$1"
    TASK_NAME="$2"
    TASK_DESC="$3"
else
    # äº¤äº’å¼è¾“å…¥
    echo -e "${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${BLUE}â•‘          ç´«å¾®æ™ºæŽ§ - ä¸€é”®å¯åŠ¨ä»»åŠ¡                       â•‘${NC}"
    echo -e "${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    
    # æ­¥éª¤ 1: è¾“å…¥ä»»åŠ¡ ID
    echo -e "${CYAN}[1/3] è¯·è¾“å…¥ä»»åŠ¡ ID:${NC}"
    echo "  æ ¼å¼ï¼šTASK-æ—¥æœŸ - åºå·ï¼ˆä¾‹å¦‚ï¼šTASK-20250227-001ï¼‰"
    read -p "  ä»»åŠ¡ ID: " TASK_ID
    
    # éªŒè¯ä»»åŠ¡ ID æ ¼å¼
    if [ -z "$TASK_ID" ]; then
        echo -e "${RED}âœ— é”™è¯¯ï¼šä»»åŠ¡ ID ä¸èƒ½ä¸ºç©º${NC}"
        exit 1
    fi
    
    echo ""
    
    # æ­¥éª¤ 2: è¾“å…¥ä»»åŠ¡åç§°
    echo -e "${CYAN}[2/3] è¯·è¾“å…¥ä»»åŠ¡åç§°:${NC}"
    echo "  ä¾‹å¦‚ï¼šè®¡ç®—å™¨é¡¹ç›®ã€ç”µå•†ç½‘ç«™ã€æ•°æ®åˆ†æžè„šæœ¬"
    read -p "  ä»»åŠ¡åç§°ï¼š " TASK_NAME
    
    # éªŒè¯ä»»åŠ¡åç§°
    if [ -z "$TASK_NAME" ]; then
        echo -e "${RED}âœ— é”™è¯¯ï¼šä»»åŠ¡åç§°ä¸èƒ½ä¸ºç©º${NC}"
        exit 1
    fi
    
    echo ""
    
    # æ­¥éª¤ 3: è¾“å…¥ä»»åŠ¡æè¿°
    echo -e "${CYAN}[3/3] è¯·è¾“å…¥ä»»åŠ¡æè¿°:${NC}"
    echo "  è¯¦ç»†æè¿°ä»»åŠ¡éœ€æ±‚ï¼ˆå¯é€‰ï¼Œç›´æŽ¥å›žè½¦è·³è¿‡ï¼‰"
    read -p "  ä»»åŠ¡æè¿°ï¼š " TASK_DESC
    
    # å¦‚æžœæè¿°ä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤å€¼
    if [ -z "$TASK_DESC" ]; then
        TASK_DESC="ç´«å¾®æ™ºæŽ§é¡¹ç›®ï¼š$TASK_NAME"
    fi
    
    echo ""
fi

# è®¾ç½®é»˜è®¤å€¼ï¼ˆå¦‚æžœæœªæä¾›ï¼‰
if [ -z "$TASK_NAME" ]; then
    TASK_NAME="ç´«å¾®æ™ºæŽ§-$TASK_ID"
fi

if [ -z "$TASK_DESC" ]; then
    TASK_DESC="ç´«å¾®æ™ºæŽ§é¡¹ç›®ï¼š$TASK_NAME"
fi

# ä»“åº“åç§°
REPO_NAME=$(echo "$TASK_ID" | tr '[:upper:]' '[:lower:]' | tr -cd 'a-z0-9-')

echo -e "${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${BLUE}â•‘          ç´«å¾®æ™ºæŽ§ - ä¸€é”®å¯åŠ¨ä»»åŠ¡                       â•‘${NC}"
echo -e "${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
echo -e "${CYAN}ä»»åŠ¡ä¿¡æ¯:${NC}"
echo "  ID: $TASK_ID"
echo "  åç§°ï¼š$TASK_NAME"
echo "  æè¿°ï¼š$TASK_DESC"
echo "  ä»“åº“ï¼š$REPO_NAME"
echo ""

# =============================================================================
# æ­¥éª¤ 1: åˆ›å»ºé¡¹ç›®ï¼ˆGitHub + Giteeï¼‰
# =============================================================================
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${MAGENTA}[æ­¥éª¤ 1/6] åˆ›å»ºé¡¹ç›®ï¼ˆGitHub + Giteeï¼‰${NC}"
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

bash scripts/create-project.sh "$TASK_ID" "$TASK_NAME" "$TASK_DESC"

if [ $? -ne 0 ]; then
    echo -e "${RED}âœ— é¡¹ç›®åˆ›å»ºå¤±è´¥ï¼Œç»ˆæ­¢æµç¨‹${NC}"
    exit 1
fi

echo ""
echo -e "${GREEN}âœ“ æ­¥éª¤ 1 å®Œæˆï¼šé¡¹ç›®å·²åˆ›å»º${NC}"
echo ""
sleep 2

# =============================================================================
# æ­¥éª¤ 2: ç­‰å¾… GitHub/Gitee å‡†å¤‡å°±ç»ª
# =============================================================================
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${MAGENTA}[æ­¥éª¤ 2/6] ç­‰å¾…ä»“åº“å‡†å¤‡å°±ç»ª${NC}"
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

echo "  ç­‰å¾… GitHub/Gitee åˆå§‹åŒ–ä»“åº“..."
sleep 5

echo -e "  ${GREEN}âœ“${NC} ä»“åº“å·²å°±ç»ª"
echo ""
sleep 1

# =============================================================================
# æ­¥éª¤ 3: å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°
# =============================================================================
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${MAGENTA}[æ­¥éª¤ 3/6] å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°${NC}"
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

PROJECT_DIR="$Ziwei_DIR/projects/$TASK_ID"

# å¦‚æžœå·²å­˜åœ¨ï¼Œå…ˆå¤‡ä»½
if [ -d "$PROJECT_DIR/.git" ]; then
    echo -e "  ${YELLOW}!${NC} é¡¹ç›®å·²å­˜åœ¨ï¼Œè·³è¿‡å…‹éš†"
else
    # ä»Ž GitHub å…‹éš†
    GITHUB_REPO="git@github.com:ziwei-control/$REPO_NAME.git"
    
    echo "  ä»Ž GitHub å…‹éš†..."
    git clone "$GITHUB_REPO" "$PROJECT_DIR" 2>&1 | tail -3
    
    if [ -d "$PROJECT_DIR/.git" ]; then
        echo -e "  ${GREEN}âœ“${NC} å…‹éš†æˆåŠŸ"
    else
        echo -e "  ${YELLOW}!${NC} å…‹éš†å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°ç›®å½•"
        mkdir -p "$PROJECT_DIR"
    fi
fi

echo ""
echo -e "${GREEN}âœ“ æ­¥éª¤ 3 å®Œæˆï¼šé¡¹ç›®å·²å…‹éš†${NC}"
echo ""
sleep 1

# =============================================================================
# æ­¥éª¤ 4: åˆ›å»ºä»»åŠ¡æ–‡ä»¶
# =============================================================================
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${MAGENTA}[æ­¥éª¤ 4/6] åˆ›å»ºä»»åŠ¡æ–‡ä»¶${NC}"
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

TASK_FILE="$PROJECT_DIR/TASK.md"

cat > "$TASK_FILE" << EOF
---
ä»»åŠ¡ ID: $TASK_ID
åˆ›å»ºæ—¶é—´ï¼š$(date '+%Y-%m-%d %H:%M:%S')
åˆ›å»ºè€…ï¼šMartin
ä¼˜å…ˆçº§ï¼šé«˜
æˆªæ­¢æ—¶é—´ï¼š$(date -d "+7 days" '+%Y-%m-%d' 2>/dev/null || date '+%Y-%m-%d')
çŠ¶æ€ï¼šInbox
---

# $TASK_NAME

## ä»»åŠ¡æè¿°

$TASK_DESC

## æœŸæœ›è¾“å‡º

1. å®Œæ•´çš„æºä»£ç 
2. README æ–‡æ¡£
3. ä½¿ç”¨è¯´æ˜Ž
4. æµ‹è¯•ç”¨ä¾‹ï¼ˆå¦‚é€‚ç”¨ï¼‰

## éªŒæ”¶æ ‡å‡†

- [ ] åŠŸèƒ½å®Œæ•´
- [ ] ä»£ç è§„èŒƒ
- [ ] æ–‡æ¡£å®Œæ•´
- [ ] æµ‹è¯•é€šè¿‡

## æ‰§è¡Œè®°å½•

### ä»»åŠ¡åˆ†è§£
- **åˆ†è§£æ—¶é—´**: -
- **åˆ†è§£è€…**: T-01 é¦–å¸­æž¶æž„å¸ˆ
- **å­ä»»åŠ¡**:
  1. å¾…åˆ†è§£

### æ‰§è¡Œè¿›åº¦
- [ ] ä»»åŠ¡æŽ¥å…¥
- [ ] ä»»åŠ¡åˆ†è§£
- [ ] ä»£ç ç”Ÿæˆ
- [ ] ä»£ç å®¡è®¡
- [ ] äº¤ä»˜
- [ ] å½’æ¡£

### å®¡è®¡è®°å½•
| æ¬¡æ•° | æ—¶é—´ | å®¡è®¡å‘˜ | ç»“æžœ | å¤‡æ³¨ |
|------|------|--------|------|------|
| - | - | - | - | - |

### äº¤ä»˜ä¿¡æ¯
- **äº¤ä»˜æ—¶é—´**: -
- **äº¤ä»˜é‚®ä»¶**: -
- **å½’æ¡£æ—¶é—´**: -
EOF

echo "  ä»»åŠ¡æ–‡ä»¶å·²åˆ›å»ºï¼š$TASK_FILE"

# åŒæ—¶åˆ›å»ºåˆ° inbox ç›®å½•
INBOX_FILE="$Ziwei_DIR/data/tasks/inbox/${TASK_ID}_$(echo "$TASK_NAME" | tr ' ' '_').md"
cp "$TASK_FILE" "$INBOX_FILE"
echo "  å·²åŒæ­¥åˆ° inbox: $INBOX_FILE"

echo ""
echo -e "${GREEN}âœ“ æ­¥éª¤ 4 å®Œæˆï¼šä»»åŠ¡æ–‡ä»¶å·²åˆ›å»º${NC}"
echo ""
sleep 1

# =============================================================================
# æ­¥éª¤ 5: æäº¤å¹¶æŽ¨é€åˆ°åŒå¹³å°
# =============================================================================
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${MAGENTA}[æ­¥éª¤ 5/6] æäº¤å¹¶æŽ¨é€åˆ°åŒå¹³å°${NC}"
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

cd "$PROJECT_DIR"

# é…ç½® Git
git config user.name "Martin"
git config user.email "pandac0@163.com"

# æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆå¦‚æžœè¿˜æ²¡æœ‰ï¼‰
git remote get-url gitee >/dev/null 2>&1 || git remote add gitee "git@gitee.com:pandac0/$REPO_NAME.git"

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤
git commit -m "åˆå§‹åŒ–é¡¹ç›®ï¼š$TASK_NAME

- ä»»åŠ¡ ID: $TASK_ID
- åˆ›å»ºæ—¶é—´ï¼š$(date '+%Y-%m-%d %H:%M:%S')
- åˆ›å»ºè€…ï¼šMartin
"

# æŽ¨é€åˆ° GitHubï¼ˆå®¹é”™æ¨¡å¼ï¼‰
echo "  æŽ¨é€åˆ° GitHub..."
if timeout 30 git push -u origin main >/dev/null 2>&1; then
    echo -e "  ${GREEN}âœ“${NC} GitHub æŽ¨é€æˆåŠŸ"
else
    echo -e "  ${YELLOW}!${NC} GitHub æŽ¨é€å¤±è´¥ï¼ˆå°†ç»§ç»­ï¼Œç¨åŽé‡è¯•ï¼‰"
fi

# æŽ¨é€åˆ° Giteeï¼ˆå®¹é”™æ¨¡å¼ï¼‰
echo "  æŽ¨é€åˆ° Gitee..."
if timeout 30 git push -u gitee main >/dev/null 2>&1; then
    echo -e "  ${GREEN}âœ“${NC} Gitee æŽ¨é€æˆåŠŸ"
else
    echo -e "  ${YELLOW}!${NC} Gitee æŽ¨é€å¤±è´¥ï¼ˆå°†ç»§ç»­ï¼Œç¨åŽé‡è¯•ï¼‰"
fi

echo ""
echo -e "${GREEN}âœ“ æ­¥éª¤ 5 å®Œæˆï¼šå·²å°è¯•æŽ¨é€åˆ°åŒå¹³å°ï¼ˆå®¹é”™ï¼‰${NC}"
echo ""
sleep 2

# =============================================================================
# æ­¥éª¤ 6: å¯åŠ¨ç´«å¾®æ™ºæŽ§å¤„ç†æµç¨‹
# =============================================================================
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${MAGENTA}[æ­¥éª¤ 6/6] å¯åŠ¨ç´«å¾®æ™ºæŽ§å¤„ç†æµç¨‹${NC}"
echo -e "${MAGENTA}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

echo "  æ›´æ–°ç³»ç»ŸçŠ¶æ€..."
cd "$Ziwei_DIR"

# æ›´æ–°ç³»ç»ŸçŠ¶æ€æ–‡ä»¶
cat > data/system_status.md << EOF
# ç´«å¾®æ™ºæŽ§ç³»ç»ŸçŠ¶æ€

## å½“å‰çŠ¶æ€
- **çŠ¶æ€**: BUSY
- **æœ€åŽæ›´æ–°**: $(date '+%Y-%m-%d %H:%M:%S')
- **å½“å‰ä»»åŠ¡**: $TASK_ID - $TASK_NAME

## ä»»åŠ¡è¿›åº¦
- [x] é¡¹ç›®åˆ›å»º
- [x] ä»“åº“å…‹éš†
- [x] ä»»åŠ¡æ–‡ä»¶åˆ›å»º
- [x] æŽ¨é€åˆ°åŒå¹³å°
- [ ] ä»»åŠ¡åˆ†è§£ï¼ˆT-01 å¤„ç†ä¸­ï¼‰
- [ ] ä»£ç ç”Ÿæˆï¼ˆT-02 å¤„ç†ä¸­ï¼‰
- [ ] ä»£ç å®¡è®¡ï¼ˆT-03 å¤„ç†ä¸­ï¼‰
- [ ] äº¤ä»˜
- [ ] å½’æ¡£

## ç»Ÿè®¡
- **æ€»ä»»åŠ¡æ•°**: $(ls -1 projects/ 2>/dev/null | wc -l | tr -d ' ')
- **è¿›è¡Œä¸­**: 1
- **æˆåŠŸäº¤ä»˜**: 0
- **å®¡è®¡é‡åš**: 0
- **æ€¥æ•‘è§¦å‘**: 0
EOF

echo -e "  ${GREEN}âœ“${NC} ç³»ç»ŸçŠ¶æ€å·²æ›´æ–°"

# è§¦å‘ç«‹å³åŒæ­¥ï¼ˆå®¹é”™æ¨¡å¼ï¼‰
echo ""
echo "  è§¦å‘ç«‹å³åŒæ­¥..."
bash scripts/sync-to-both.sh || true  # å³ä½¿å¤±è´¥ä¹Ÿç»§ç»­
echo -e "  ${GREEN}âœ“${NC} åŒæ­¥å·²è§¦å‘ï¼ˆå®¹é”™æ¨¡å¼ï¼‰"

# æ›´æ–°å¿ƒè·³
echo "[$(date -Iseconds)] æ–°ä»»åŠ¡å¯åŠ¨ï¼š$TASK_ID" >> data/health/heartbeat.log
echo -e "  ${GREEN}âœ“${NC} å¿ƒè·³å·²æ›´æ–°"

echo ""
echo -e "${GREEN}âœ“ æ­¥éª¤ 6 å®Œæˆï¼šç´«å¾®æ™ºæŽ§å·²å¯åŠ¨${NC}"
echo ""

# =============================================================================
# å®ŒæˆæŠ¥å‘Š
# =============================================================================
echo -e "${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${BLUE}â•‘              âœ… ä»»åŠ¡å¯åŠ¨å®Œæˆï¼                         â•‘${NC}"
echo -e "${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""

echo -e "${CYAN}ðŸ“¦ ä»»åŠ¡ä¿¡æ¯:${NC}"
echo "  ID: $TASK_ID"
echo "  åç§°ï¼š$TASK_NAME"
echo ""

echo -e "${CYAN}ðŸŒ ä»“åº“åœ°å€:${NC}"
echo "  GitHub: https://github.com/ziwei-control/$REPO_NAME"
echo "  Gitee:  https://gitee.com/pandac0/$REPO_NAME"
echo ""

echo -e "${CYAN}ðŸ“ æœ¬åœ°ç›®å½•:${NC}"
echo "  $PROJECT_DIR/"
echo ""

echo -e "${CYAN}ðŸ“Š ä¸‹ä¸€æ­¥è‡ªåŠ¨æ‰§è¡Œ:${NC}"
echo "  1. T-01 é¦–å¸­æž¶æž„å¸ˆ â†’ ä»»åŠ¡åˆ†è§£"
echo "  2. T-02 ä»£ç ç‰¹ç§å…µ â†’ ä»£ç ç”Ÿæˆ"
echo "  3. T-03 ä»£ç å®¡è®¡å‘˜ â†’ ä»£ç å®¡è®¡"
echo "  4. é€šä¿¡å®˜ â†’ äº¤ä»˜é‚®ä»¶"
echo "  5. è‡ªåŠ¨å½’æ¡£ â†’ GitHub/Gitee"
echo ""

echo -e "${CYAN}ðŸ“ æŸ¥çœ‹è¿›åº¦:${NC}"
echo "  # æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€"
echo "  cat $Ziwei_DIR/data/system_status.md"
echo ""
echo "  # æŸ¥çœ‹å·¡æŸ¥æ—¥å¿—"
echo "  tail -f $Ziwei_DIR/data/logs/auto_sync_*.log"
echo ""
echo "  # æŸ¥çœ‹é¡¹ç›®ç›®å½•"
echo "  ls -la $PROJECT_DIR/"
echo ""

# ä¿å­˜å®ŒæˆæŠ¥å‘Š
REPORT_FILE="$Ziwei_DIR/data/logs/task_start_$(date +%Y%m%d_%H%M%S).md"
cat > "$REPORT_FILE" << EOF
# ä»»åŠ¡å¯åŠ¨æŠ¥å‘Š

**æ—¶é—´**: $(date '+%Y-%m-%d %H:%M:%S')

## ä»»åŠ¡ä¿¡æ¯

- **ä»»åŠ¡ ID**: $TASK_ID
- **ä»»åŠ¡åç§°**: $TASK_NAME
- **ä»»åŠ¡æè¿°**: $TASK_DESC

## ä»“åº“åœ°å€

| å¹³å° | åœ°å€ |
|------|------|
| GitHub | https://github.com/ziwei-control/$REPO_NAME |
| Gitee | https://gitee.com/pandac0/$REPO_NAME |

## æœ¬åœ°ç›®å½•

$PROJECT_DIR/

## æ‰§è¡Œæ­¥éª¤

- [x] é¡¹ç›®åˆ›å»ºï¼ˆGitHub + Giteeï¼‰
- [x] ä»“åº“å…‹éš†
- [x] ä»»åŠ¡æ–‡ä»¶åˆ›å»º
- [x] æäº¤å¹¶æŽ¨é€
- [x] å¯åŠ¨ç´«å¾®æ™ºæŽ§
- [ ] ä»»åŠ¡åˆ†è§£ï¼ˆè¿›è¡Œä¸­ï¼‰
- [ ] ä»£ç ç”Ÿæˆï¼ˆç­‰å¾…ä¸­ï¼‰
- [ ] ä»£ç å®¡è®¡ï¼ˆç­‰å¾…ä¸­ï¼‰
- [ ] äº¤ä»˜ï¼ˆç­‰å¾…ä¸­ï¼‰
- [ ] å½’æ¡£ï¼ˆç­‰å¾…ä¸­ï¼‰

## ä¸‹ä¸€æ­¥

ç´«å¾®æ™ºæŽ§å°†è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š

1. **T-01 é¦–å¸­æž¶æž„å¸ˆ**: ä»»åŠ¡åˆ†è§£
2. **T-02 ä»£ç ç‰¹ç§å…µ**: ä»£ç ç”Ÿæˆ
3. **T-03 ä»£ç å®¡è®¡å‘˜**: ä»£ç å®¡è®¡ï¼ˆæœ€å¤š 20 æ¬¡ï¼‰
4. **é€šä¿¡å®˜**: å‘é€äº¤ä»˜é‚®ä»¶
5. **è‡ªåŠ¨å½’æ¡£**: 8 å°æ—¶åŽæŽ¨é€åˆ°åŒå¹³å°

## ç›‘æŽ§

- ç³»ç»ŸçŠ¶æ€ï¼š\`data/system_status.md\`
- å·¡æŸ¥æ—¥å¿—ï¼š\`data/logs/auto_sync_*.log\`
- é¡¹ç›®ç›®å½•ï¼š\`$PROJECT_DIR/\`
EOF

echo -e "${GREEN}âœ“${NC} æŠ¥å‘Šå·²ä¿å­˜ï¼š$REPORT_FILE"
echo ""

echo -e "${GREEN}ç´«å¾®æ™ºæŽ§å·²å¯åŠ¨ï¼Œä»»åŠ¡æ­£åœ¨å¤„ç†ä¸­...${NC}"
echo ""
